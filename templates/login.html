{% extends 'base.html' %} {% block content %}
<div class="signup">
  <h1>Login</h1>
  {% if error_message %}
  <div class="error">{{ error_message }}</div>
  {% endif %}
  <form method="post">
    <div class="input-wrapper">
      <input
        type="email"
        id="login_email"
        name="email"
        placeholder="Email"
        required
      />
      <div id="login-email-bar" class="input-bar"></div>
    </div>
    <div class="input-wrapper password-wrapper">
      <input
        type="password"
        id="login_password"
        name="password"
        placeholder="Password"
        required
      />
      <span id="toggleLoginPassword" class="eye-toggle">
        <svg
          id="loginEyeIcon"
          class="eye-svg"
          xmlns="http://www.w3.org/2000/svg"
          width="22"
          height="22"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
          />
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
          />
        </svg>
      </span>
    </div>
    <button class="btn" id="login_btn" type="submit">Login</button>
  </form>
  <p style="margin-top: 20px">
    Don't have an account? <a href="{{ url_for('signup') }}">Signup</a>
  </p>
</div>
<style>
  .eye-svg {
    filter: invert(1);
    display: block;
  }
  .password-wrapper {
    display: flex;
    align-items: center;
    position: relative;
  }
  .password-wrapper input[type="password"] {
    flex: 1;
  }
  .eye-toggle {
    display: flex;
    align-items: center;
    position: absolute;
    right: 10px;
    top: 0;
    bottom: 0;
    height: 100%;
    cursor: pointer;
  }
</style>
<script>
  function validateEmail(email) {
    return /^[^@]+@[^@]+\.[^@]+$/.test(email);
  }
  const emailInput = document.getElementById("login_email");
  const emailBar = document.getElementById("login-email-bar");
  const loginBtn = document.getElementById("login_btn");
  emailInput.addEventListener("input", function () {
    if (validateEmail(emailInput.value)) {
      emailBar.classList.add("valid");
      emailBar.classList.remove("invalid");
      loginBtn.disabled = false;
    } else {
      emailBar.classList.add("invalid");
      emailBar.classList.remove("valid");
      loginBtn.disabled = true;
    }
  });
  // Password eye toggle for login
  const loginPasswordInput = document.getElementById("login_password");
  const toggleLoginPassword = document.getElementById("toggleLoginPassword");
  // SVGs for show/hide
  const loginEyeOpen = `<svg id="loginEyeIcon" class="eye-svg" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>`;
  const loginEyeClosed = `<svg id="loginEyeIcon" class="eye-svg" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.542-7a9.956 9.956 0 012.293-3.95m3.161-2.522A9.956 9.956 0 0112 5c4.478 0 8.268 2.943 9.542 7a9.973 9.973 0 01-4.293 5.032M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3l18 18"/></svg>`;
  let loginShowing = false;
  toggleLoginPassword.addEventListener("click", function () {
    loginShowing = !loginShowing;
    loginPasswordInput.setAttribute("type", loginShowing ? "text" : "password");
    toggleLoginPassword.innerHTML = loginShowing
      ? loginEyeClosed
      : loginEyeOpen;
  });
</script>
{% endblock %}
